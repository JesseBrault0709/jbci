generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id       Int       @id @default(autoincrement())
  username String    @unique
  password String
  sessions Session[]
}

model Session {
  id      Int      @id @default(autoincrement())
  sid     String   @unique
  user    User?    @relation(fields: [userId], references: [id])
  userId  Int?
  created DateTime @default(now())
  expires DateTime
}

model EmptySuccessHookResult {
  id            Int      @id @default(autoincrement())
  resStatusCode Int
  created       DateTime @default(now())
}

model BuildHookResult {
  id            Int      @id @default(autoincrement())
  resStatusCode Int
  created       DateTime @default(now())
  build         Build    @relation(fields: [buildId], references: [id])
  buildId       Int      @unique
}

model Build {
  id              Int              @id @default(autoincrement())
  updated         DateTime         @updatedAt
  log             String?
  buildHookResult BuildHookResult?
  states          BuildState[]
}

model BuildState {
  id               Int      @id @default(autoincrement())
  created          DateTime @default(now())
  progress         String
  completionStatus String?
  Build            Build    @relation(fields: [buildId], references: [id])
  buildId          Int
}

model FailureHookResult {
  id            Int      @id @default(autoincrement())
  resStatusCode Int
  created       DateTime @default(now())
  msg           String?
}
